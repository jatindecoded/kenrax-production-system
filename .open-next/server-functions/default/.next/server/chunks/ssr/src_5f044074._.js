module.exports=[70069,a=>{"use strict";function b(a){let b=[];return a.part_number&&0!==a.part_number.trim().length?a.part_number.trim().length<2&&b.push({field:"part_number",message:"Part number must be at least 2 characters"}):b.push({field:"part_number",message:"Part number is required"}),a.product_type?["AIR_FILTER","OIL_FILTER","AIR_OIL_SEPARATOR"].includes(a.product_type)||b.push({field:"product_type",message:"Product type must be AIR_FILTER, OIL_FILTER, or AIR_OIL_SEPARATOR"}):b.push({field:"product_type",message:"Product type is required"}),a.description&&a.description.trim().length>500&&b.push({field:"description",message:"Description must be 500 characters or less"}),{isValid:0===b.length,errors:b}}function c(a){let b=[];if(a.product_id||b.push({field:"product_id",message:"Please select a product"}),a.quantity){let c="string"==typeof a.quantity?parseInt(a.quantity,10):a.quantity;(isNaN(c)||c<=0)&&b.push({field:"quantity",message:"Quantity must be a positive number"})}else b.push({field:"quantity",message:"Quantity is required"});return a.remarks&&a.remarks.trim().length>500&&b.push({field:"remarks",message:"Remarks must be 500 characters or less"}),{isValid:0===b.length,errors:b}}a.s(["validateBatch",()=>c,"validateProduct",()=>b])},70336,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(70069);function f(){let a=(0,d.useRouter)(),f=(0,c.useRef)(null),[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)({batch_code:"",product_id:"",product_search:"",quantity:"",produced_by:"",production_line:"",remarks:""}),[w,x]=(0,c.useState)([]);(0,c.useEffect)(()=>{y()},[]),(0,c.useEffect)(()=>{let a=a=>{f.current&&!f.current.contains(a.target)&&t(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);let y=async()=>{try{r(!0);let a=await fetch("/api/products"),b=await a.json();a.ok&&(n(b),p(b))}catch(a){console.error("Failed to fetch products:",a)}finally{r(!1)}},z=a=>{let{name:b,value:c}=a.target;v(a=>({...a,[b]:c})),"product_search"===b&&(""===c.trim()?p(m):p(m.filter(a=>a.part_number.toLowerCase().includes(c.toLowerCase())||a.product_type.toLowerCase().includes(c.toLowerCase())||a.description&&a.description.toLowerCase().includes(c.toLowerCase()))),t(!0))},A=async b=>{if(b.preventDefault(),j(null),x([]),!u.product_id)return void j("Please select a product");let c=(0,e.validateBatch)({product_id:u.product_id,quantity:u.quantity,produced_by:u.produced_by,production_line:u.production_line,remarks:u.remarks});if(!c.isValid)return void x(c.errors);h(!0);try{let b=await fetch("/api/batches",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({batch_code:u.batch_code,product_id:parseInt(u.product_id,10),quantity:parseInt(u.quantity,10),produced_by:u.produced_by||null,production_line:u.production_line||null,remarks:u.remarks||null})}),c=await b.json();if(!b.ok)return void j(c.error||"Failed to create batch");l(!0),v({batch_code:"",product_id:"",product_search:"",quantity:"",produced_by:"",production_line:"",remarks:""}),setTimeout(()=>{a.push("/batches")},2e3)}catch(a){j("An unexpected error occurred"),console.error(a)}finally{h(!1)}};return(0,b.jsx)("div",{className:"bg-white flex flex-col items-center p-4",style:{fontFamily:"var(--font-geist-sans)"},children:(0,b.jsxs)("div",{className:"w-full max-w-md",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold text-black tracking-tight",children:"New Production Batch"}),u.product_search&&(0,b.jsxs)("p",{className:"text-sm text-slate-600 mt-2",children:["Product: ",(0,b.jsx)("span",{className:"font-medium text-black",children:u.product_search})]})]}),i&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded text-red-700 text-sm font-medium",children:i}),k&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded text-green-700 text-sm font-medium",children:"âœ“ Production batch created. Redirecting..."}),q?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-slate-300 border-t-blue-600 mb-2"}),(0,b.jsx)("p",{className:"text-sm text-slate-600",children:"Loading..."})]}):0===m.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("p",{className:"text-sm text-slate-600 mb-3",children:"No products available"}),(0,b.jsx)("a",{href:"/products/add",className:"inline-block px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded hover:bg-blue-700 transition-colors",children:"Add Product"})]}):(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,b.jsxs)("div",{ref:f,children:[(0,b.jsxs)("label",{htmlFor:"product_search",className:"block text-xs font-semibold text-slate-900 uppercase tracking-wide mb-2",children:["Product ",(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{id:"product_search",name:"product_search",type:"text",value:u.product_search,onChange:z,onFocus:()=>t(!0),onKeyDown:a=>{"Enter"===a.key&&a.currentTarget.blur()},enterKeyHint:"done",placeholder:"Search products...",autoComplete:"off",className:`w-full px-3 py-2 border rounded text-base bg-white text-black placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent transition-all ${w.some(a=>"product_id"===a.field)?"border-red-300 bg-red-50":"border-slate-300"}`}),s&&o.length>0&&(0,b.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white border border-slate-300 rounded shadow-md max-h-56 overflow-y-auto",children:o.map(a=>(0,b.jsxs)("button",{type:"button",onClick:()=>{v(b=>({...b,product_id:String(a.id),product_search:`${a.part_number} - ${a.product_type}`})),t(!1)},className:"w-full text-left px-3 py-2 hover:bg-slate-100 transition-colors border-b border-slate-100 last:border-b-0 text-sm",children:[(0,b.jsx)("div",{className:"font-medium text-slate-900 underline decoration-dashed underline-offset-2",children:a.part_number}),(0,b.jsx)("div",{className:"text-xs text-slate-600",children:a.product_type})]},a.id))}),s&&0===o.length&&u.product_search&&(0,b.jsxs)("div",{className:"absolute z-10 w-full mt-1 bg-white border border-slate-300 rounded shadow-md overflow-hidden",children:[(0,b.jsx)("div",{className:"p-3 text-center text-slate-500 text-xs border-b border-slate-200",children:"No products found"}),(0,b.jsx)("a",{href:`/products/add?part_number=${encodeURIComponent(u.product_search)}`,className:"block w-full px-3 py-2 text-left text-xs font-medium text-black hover:bg-slate-50 transition-colors uppercase tracking-wide",children:"+ Create New Product"})]})]}),w.some(a=>"product_id"===a.field)&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:w.find(a=>"product_id"===a.field)?.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"quantity",className:"block text-xs font-semibold text-slate-900 uppercase tracking-wide mb-2",children:["Quantity ",(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,b.jsx)("input",{id:"quantity",name:"quantity",type:"number",inputMode:"numeric",enterKeyHint:"done",min:"1",value:u.quantity,onChange:z,onKeyDown:a=>{"Enter"===a.key&&a.currentTarget.blur()},placeholder:"0",className:`w-full px-3 py-2 border rounded text-base bg-white text-black placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent transition-all ${w.some(a=>"quantity"===a.field)?"border-red-300 bg-red-50":"border-slate-300"}`}),w.some(a=>"quantity"===a.field)&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:w.find(a=>"quantity"===a.field)?.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"batch_code",className:"block text-xs font-semibold text-slate-900 uppercase tracking-wide mb-2",children:"Batch Code"}),(0,b.jsx)("input",{id:"batch_code",name:"batch_code",type:"text",inputMode:"numeric",enterKeyHint:"done",value:u.batch_code,onChange:z,onKeyDown:a=>{"Enter"===a.key&&a.currentTarget.blur()},placeholder:"240701001",className:`w-full px-3 py-2 border rounded text-base bg-white text-black placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent transition-all font-mono ${w.some(a=>"batch_code"===a.field)?"border-red-300 bg-red-50":"border-slate-300"}`,style:{fontFamily:"var(--font-jetbrains-mono)",letterSpacing:"0.05em"}}),(0,b.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Format: YYMMXXX (year, month, quantity)"}),w.some(a=>"batch_code"===a.field)&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:w.find(a=>"batch_code"===a.field)?.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"produced_by",className:"block text-xs font-semibold text-slate-900 uppercase tracking-wide mb-2",children:["Produced By ",(0,b.jsx)("span",{className:"font-normal text-slate-500",children:"(Optional)"})]}),(0,b.jsx)("input",{id:"produced_by",name:"produced_by",type:"text",enterKeyHint:"done",value:u.produced_by,onChange:z,onKeyDown:a=>{"Enter"===a.key&&a.currentTarget.blur()},placeholder:"Name",className:"w-full px-3 py-2 border border-slate-300 rounded text-base bg-white text-black placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent transition-all"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"production_line",className:"block text-xs font-semibold text-slate-900 uppercase tracking-wide mb-2",children:["Line ",(0,b.jsx)("span",{className:"font-normal text-slate-500",children:"(Optional)"})]}),(0,b.jsx)("input",{id:"production_line",name:"production_line",type:"text",enterKeyHint:"done",value:u.production_line,onChange:z,onKeyDown:a=>{"Enter"===a.key&&a.currentTarget.blur()},placeholder:"Line A",className:"w-full px-3 py-2 border border-slate-300 rounded text-base bg-white text-black placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent transition-all"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"remarks",className:"block text-xs font-semibold text-slate-900 uppercase tracking-wide mb-2",children:["Remarks ",(0,b.jsx)("span",{className:"font-normal text-slate-500",children:"(Optional)"})]}),(0,b.jsx)("textarea",{id:"remarks",name:"remarks",enterKeyHint:"done",value:u.remarks,onChange:z,placeholder:"Notes...",rows:2,className:`w-full px-3 py-2 border rounded text-base bg-white text-black placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent transition-all resize-none ${w.some(a=>"remarks"===a.field)?"border-red-300 bg-red-50":"border-slate-300"}`}),w.some(a=>"remarks"===a.field)&&(0,b.jsx)("p",{className:"text-xs text-red-600 mt-1",children:w.find(a=>"remarks"===a.field)?.message})]}),(0,b.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,b.jsx)("button",{type:"submit",disabled:g,className:"flex-1 px-4 py-3 bg-black text-white font-semibold rounded hover:bg-slate-900 disabled:bg-slate-400 disabled:cursor-not-allowed transition-colors text-sm tracking-wide uppercase",children:g?"Creating...":"Create"}),(0,b.jsx)("button",{type:"button",onClick:()=>a.back(),className:"flex-1 px-4 py-3 bg-slate-200 text-slate-900 font-semibold rounded hover:bg-slate-300 transition-colors text-sm tracking-wide uppercase",children:"Cancel"})]})]})})]})})}a.s(["default",()=>f])}];

//# sourceMappingURL=src_5f044074._.js.map