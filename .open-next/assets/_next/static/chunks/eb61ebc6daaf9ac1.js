(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,r)=>{t.exports=e.r(76562)},95018,e=>{"use strict";function t(e){let t=[];return e.part_number&&0!==e.part_number.trim().length?e.part_number.trim().length<2&&t.push({field:"part_number",message:"Part number must be at least 2 characters"}):t.push({field:"part_number",message:"Part number is required"}),e.product_type?["AIR_FILTER","OIL_FILTER","AIR_OIL_SEPARATOR"].includes(e.product_type)||t.push({field:"product_type",message:"Product type must be AIR_FILTER, OIL_FILTER, or AIR_OIL_SEPARATOR"}):t.push({field:"product_type",message:"Product type is required"}),e.description&&e.description.trim().length>500&&t.push({field:"description",message:"Description must be 500 characters or less"}),{isValid:0===t.length,errors:t}}function r(e){let t=[];if(e.product_id||t.push({field:"product_id",message:"Please select a product"}),e.quantity){let r="string"==typeof e.quantity?parseInt(e.quantity,10):e.quantity;(isNaN(r)||r<=0)&&t.push({field:"quantity",message:"Quantity must be a positive number"})}else t.push({field:"quantity",message:"Quantity is required"});return e.remarks&&e.remarks.trim().length>500&&t.push({field:"remarks",message:"Remarks must be 500 characters or less"}),{isValid:0===t.length,errors:t}}e.s(["validateBatch",()=>r,"validateProduct",()=>t])},82678,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(18566),a=e.i(95018);function l(){let e=(0,s.useRouter)(),l=(0,r.useRef)(null),[o,d]=(0,r.useState)(!1),[n,i]=(0,r.useState)(null),[c,u]=(0,r.useState)(!1),[m,p]=(0,r.useState)([]),[b,x]=(0,r.useState)([]),[h,f]=(0,r.useState)(!0),[g,y]=(0,r.useState)(!1),[_,j]=(0,r.useState)({batch_code:"",product_id:"",product_search:"",quantity:"",produced_by:"",production_line:"",remarks:""}),[k,N]=(0,r.useState)([]);(0,r.useEffect)(()=>{w()},[]),(0,r.useEffect)(()=>{let e=e=>{l.current&&!l.current.contains(e.target)&&y(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let w=async()=>{try{f(!0);let e=await fetch("/api/products"),t=await e.json();e.ok&&(p(t),x(t))}catch(e){console.error("Failed to fetch products:",e)}finally{f(!1)}},v=e=>{let{name:t,value:r}=e.target;j(e=>({...e,[t]:r})),"product_search"===t&&(""===r.trim()?x(m):x(m.filter(e=>e.part_number.toLowerCase().includes(r.toLowerCase())||e.product_type.toLowerCase().includes(r.toLowerCase())||e.description&&e.description.toLowerCase().includes(r.toLowerCase()))),y(!0))},q=async t=>{if(t.preventDefault(),!_.product_id)return void i("Please select a product");let r=(0,a.validateBatch)({product_id:_.product_id,quantity:_.quantity,produced_by:_.produced_by,production_line:_.production_line,remarks:_.remarks});if(!r.isValid)return void N(r.errors);d(!0),i(null),N([]);try{let t=await fetch("/api/batches",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({batch_code:_.batch_code,product_id:parseInt(_.product_id,10),quantity:parseInt(_.quantity,10),produced_by:_.produced_by||null,production_line:_.production_line||null,remarks:_.remarks||null})}),r=await t.json();if(!t.ok)return void i(r.error||"Failed to create batch");u(!0),j({batch_code:"",product_id:"",product_search:"",quantity:"",produced_by:"",production_line:"",remarks:""}),setTimeout(()=>{e.push("/batches")},2e3)}catch(e){i("An unexpected error occurred"),console.error(e)}finally{d(!1)}};return(0,t.jsx)("div",{className:"bg-white flex flex-col items-center justify-center p-4",style:{fontFamily:"var(--font-geist-sans)"},children:(0,t.jsxs)("div",{className:"w-full max-w-md my-auto",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold text-black tracking-tight",children:"New Production Batch"}),_.product_search&&(0,t.jsxs)("p",{className:"text-sm text-slate-600 mt-2",children:["Product: ",(0,t.jsx)("span",{className:"font-medium text-black",children:_.product_search})]})]}),n&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded text-red-700 text-sm font-medium",children:n}),c&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded text-green-700 text-sm font-medium",children:"âœ“ Production batch created. Redirecting..."}),h?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-slate-300 border-t-blue-600 mb-2"}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:"Loading..."})]}):0===m.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("p",{className:"text-sm text-slate-600 mb-3",children:"No products available"}),(0,t.jsx)("a",{href:"/products/add",className:"inline-block px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded hover:bg-blue-700 transition-colors",children:"Add Product"})]}):(0,t.jsxs)("form",{onSubmit:q,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"batch_code",className:"block text-xs font-semibold text-slate-900 uppercase tracking-wide mb-2",children:"Batch Code"}),(0,t.jsx)("input",{id:"batch_code",name:"batch_code",type:"text",value:_.batch_code,onChange:v,placeholder:"240701001",className:`w-full px-3 py-2 border rounded text-sm bg-white text-black placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent transition-all font-mono ${k.some(e=>"batch_code"===e.field)?"border-red-300 bg-red-50":"border-slate-300"}`,style:{fontFamily:"var(--font-jetbrains-mono)",letterSpacing:"0.05em"},autoComplete:"off"}),(0,t.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Format: YYMMXXX (year, month, sequence)"}),k.some(e=>"batch_code"===e.field)&&(0,t.jsx)("p",{className:"text-xs text-red-600 mt-1",children:k.find(e=>"batch_code"===e.field)?.message})]}),(0,t.jsxs)("div",{ref:l,children:[(0,t.jsx)("label",{htmlFor:"product_search",className:"block text-xs font-semibold text-slate-900 uppercase tracking-wide mb-2",children:"Product"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{id:"product_search",name:"product_search",type:"text",value:_.product_search,onChange:v,onFocus:()=>y(!0),placeholder:"Search products...",autoComplete:"off",className:`w-full px-3 py-2 border rounded text-sm bg-white text-black placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent transition-all ${k.some(e=>"product_id"===e.field)?"border-red-300 bg-red-50":"border-slate-300"}`}),g&&b.length>0&&(0,t.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white border border-slate-300 rounded shadow-md max-h-56 overflow-y-auto",children:b.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>{j(t=>({...t,product_id:String(e.id),product_search:`${e.part_number} (${e.product_type})`})),y(!1)},className:"w-full text-left px-3 py-2 hover:bg-slate-100 transition-colors border-b border-slate-100 last:border-b-0 text-sm",children:[(0,t.jsx)("div",{className:"font-medium text-slate-900",children:e.part_number}),(0,t.jsx)("div",{className:"text-xs text-slate-600",children:e.product_type})]},e.id))}),g&&0===b.length&&_.product_search&&(0,t.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white border border-slate-300 rounded shadow-md p-3 text-center text-slate-500 text-xs",children:"No products found"})]}),k.some(e=>"product_id"===e.field)&&(0,t.jsx)("p",{className:"text-xs text-red-600 mt-1",children:k.find(e=>"product_id"===e.field)?.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"quantity",className:"block text-xs font-semibold text-slate-900 uppercase tracking-wide mb-2",children:"Quantity"}),(0,t.jsx)("input",{id:"quantity",name:"quantity",type:"number",min:"1",value:_.quantity,onChange:v,placeholder:"0",className:`w-full px-3 py-2 border rounded text-sm bg-white text-black placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent transition-all ${k.some(e=>"quantity"===e.field)?"border-red-300 bg-red-50":"border-slate-300"}`}),k.some(e=>"quantity"===e.field)&&(0,t.jsx)("p",{className:"text-xs text-red-600 mt-1",children:k.find(e=>"quantity"===e.field)?.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"produced_by",className:"block text-xs font-semibold text-slate-900 uppercase tracking-wide mb-2",children:["Produced By ",(0,t.jsx)("span",{className:"font-normal text-slate-500",children:"(Optional)"})]}),(0,t.jsx)("input",{id:"produced_by",name:"produced_by",type:"text",value:_.produced_by,onChange:v,placeholder:"Name",className:"w-full px-3 py-2 border border-slate-300 rounded text-sm bg-white text-black placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent transition-all"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"production_line",className:"block text-xs font-semibold text-slate-900 uppercase tracking-wide mb-2",children:["Line ",(0,t.jsx)("span",{className:"font-normal text-slate-500",children:"(Optional)"})]}),(0,t.jsx)("input",{id:"production_line",name:"production_line",type:"text",value:_.production_line,onChange:v,placeholder:"Line A",className:"w-full px-3 py-2 border border-slate-300 rounded text-sm bg-white text-black placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent transition-all"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"remarks",className:"block text-xs font-semibold text-slate-900 uppercase tracking-wide mb-2",children:["Remarks ",(0,t.jsx)("span",{className:"font-normal text-slate-500",children:"(Optional)"})]}),(0,t.jsx)("textarea",{id:"remarks",name:"remarks",value:_.remarks,onChange:v,placeholder:"Notes...",rows:2,className:`w-full px-3 py-2 border rounded text-sm bg-white text-black placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent transition-all resize-none ${k.some(e=>"remarks"===e.field)?"border-red-300 bg-red-50":"border-slate-300"}`}),k.some(e=>"remarks"===e.field)&&(0,t.jsx)("p",{className:"text-xs text-red-600 mt-1",children:k.find(e=>"remarks"===e.field)?.message})]}),(0,t.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,t.jsx)("button",{type:"submit",disabled:o,className:"flex-1 px-4 py-3 bg-black text-white font-semibold rounded hover:bg-slate-900 disabled:bg-slate-400 disabled:cursor-not-allowed transition-colors text-sm tracking-wide uppercase",children:o?"Creating...":"Create"}),(0,t.jsx)("button",{type:"button",onClick:()=>e.back(),className:"flex-1 px-4 py-3 bg-slate-200 text-slate-900 font-semibold rounded hover:bg-slate-300 transition-colors text-sm tracking-wide uppercase",children:"Cancel"})]})]})]})})}e.s(["default",()=>l])}]);